webpackJsonp([6],{229:function(e,t,a){var n=a(230);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(9)("2c0bea45",n,!0,{})},230:function(e,t,a){(e.exports=a(2)(!1)).push([e.i,".demo-table-expand{font-size:0}.demo-table-expand label{width:90px;color:#99a9bf}.demo-table-expand .el-form-item{margin-right:0;margin-bottom:0;width:50%}",""])},231:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{messages:[],answerMessageId:0,answerMessageFlag:!1,comment:"",keyword:"",pagination:{current:1,total:0,pageSize:20}}},methods:{formatter:function(e,t){return e.content.length>15?e.content.substring(0,15)+"~~~":e.content},confirmAnswerMessage:function(){var e=this,t=this;axios.post("/admin/message/answer",{id:t.answerMessageId,content:t.comment}).then(function(a){0===a.data.code?(t.$message({title:"提示",message:a.data.msg,type:"success"}),t.answerMessageId=0,e.answerMessageFlag=!1,t.comment="",t.search()):t.$message({title:"提示",message:a.data.msg,type:"warning"})})},openAnswerMessage:function(e){this.answerMessageId=e,this.answerMessageFlag=!0},filterTag:function(e,t,a){return t[a.property]===e},search:function(){var e=this,t={page:e.pagination.current,pageSize:e.pagination.pageSize,keyword:e.keyword};axios.get("/admin/message/lists",{params:t}).then(function(t){t?(e.messages=t.data.data,console.log(e.messages),e.pagination.total=t.data.total):console.log(t.data.msg)})},deleteMessage:function(e){var t=this;this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){axios.post("/admin/message/delete",{id:e}).then(function(e){0===e.data.code?(t.$message({title:"提示",message:e.data.msg,type:"success"}),t.search()):t.$message({title:"提示",message:e.data.msg,type:"warning"})})}).catch(function(){})},handleSizeChange:function(e){this.pagination.pageSize=e,this.search(),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pagination.current=e,this.search(),console.log("当前页: "+e)}},mounted:function(){this.search()}}},232:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"gm-breadcrumb"},[a("i",{staticClass:"ion-ios-home gm-home"}),e._v(" "),a("el-breadcrumb",[a("el-breadcrumb-item",[e._v("留言管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("留言列表")])],1)],1),e._v(" "),a("el-form",{attrs:{inline:!0},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}}},[a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{attrs:{placeholder:"留言人"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.messages,border:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left"}},[a("el-card",[a("el-form-item",{attrs:{label:"留言人"}},[a("span",[e._v(e._s(t.row.author))])]),e._v(" "),a("el-form-item",{attrs:{label:"留言时间"}},[a("span",[e._v(e._s(t.row.created_at))])]),e._v(" "),a("el-form-item",{attrs:{label:"留言内容"}},[a("span",[e._v(e._s(t.row.content))])]),e._v(" "),"0"===t.row.type?a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.openAnswerMessage(t.row.id)}}},[e._v("回 复")])],1):e._e()],1),e._v(" "),"1"===t.row.type?a("el-card",{staticStyle:{"margin-top":"10px"}},[a("el-form-item",{attrs:{label:"回复人"}},[a("span",[e._v(e._s(t.row.comment.author))])]),e._v(" "),a("el-form-item",{attrs:{label:"回复时间"}},[a("span",[e._v(e._s(t.row.comment.created_at))])]),e._v(" "),a("el-form-item",{attrs:{label:"回复内容"}},[a("span",[e._v(e._s(t.row.comment.content))])])],1):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"#"}}),e._v(" "),a("el-table-column",{attrs:{prop:"author",label:"留言人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"留言内容",formatter:e.formatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"留言时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"状态",filters:[{text:"未回复",value:"0"},{text:"已回复",value:"1"}],"filter-method":e.filterTag},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"0"===t.row.type?"danger":"info"}},["0"===t.row.type?a("span",[e._v("未回复")]):a("span",[e._v("已回复")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.deleteMessage(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"回复内容",visible:e.answerMessageFlag,width:"30%"},on:{"update:visible":function(t){e.answerMessageFlag=t}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmAnswerMessage}},[e._v("确 定")])],1)],1),e._v(" "),a("el-pagination",{staticStyle:{padding:"1rem 0"},attrs:{"current-page":e.pagination.current,"page-sizes":[10,20,50,100],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]}},272:function(e,t,a){var n=a(5)(a(231),a(232),!1,function(e){a(229)},null,null);e.exports=n.exports}});